(function(e, t) {
	"use strict";
	var n = Array.prototype,
		r = Date.prototype,
		i = Function.prototype,
		o = String.prototype,
		a = Object.prototype.hasOwnProperty;
	if (!n.indexOf) {
		n.indexOf = function(e, t) {
			var n = this.length;
			t = parseInt(t) || 0;
			if (t < 0) {
				t += n
			}
			for (; t < n; t++) {
				if (this[t] === e) {
					return t
				}
			}
			return -1
		}
	}
	if (!n.lastIndexOf) {
		n.lastIndexOf = function(e, t) {
			var n = this.length;
			t = parseInt(t) || n - 1;
			if (t < 0) {
				t += n
			}
			for (; t >= 0; t--) {
				if (this[t] === e) {
					return t
				}
			}
			return -1
		}
	}
	if (!n.every) {
		n.every = function(e, t) {
			var n = this.length,
				r = 0;
			for (; r < n; r++) {
				if (!e.call(t, this[r], r, this)) {
					return false
				}
			}
			return true
		}
	}
	if (!n.some) {
		n.some = function(e, t) {
			var n = this.length,
				r = 0;
			for (; r < n; r++) {
				if (e.call(t, this[r], r, this)) {
					return true
				}
			}
			return false
		}
	}
	if (!n.forEach) {
		n.forEach = function(e, t) {
			var n = this.length,
				r = 0;
			for (; r < n; r++) {
				e.call(t, this[r], r, this)
			}
		}
	}
	if (!n.map) {
		n.map = function(e, t) {
			var n = this.length,
				r = [],
				i = 0,
				o = 0;
			for (; i < n; i++) {
				r[o++] = e.call(t, this[i], i, this)
			}
			return r
		}
	}
	if (!n.filter) {
		n.filter = function(e, t) {
			var n = this.length,
				r = [],
				i = 0,
				o = 0,
				a;
			for (; i < n; i++) {
				a = this[i];
				if (e.call(t, a, i, this)) {
					r[o++] = a
				}
			}
			return r
		}
	}
	if (!n.reduce) {
		n.reduce = function(e, n) {
			var r = this.length,
				i = 0;
			if (n === t) {
				n = this[i++]
			}
			for (; i < r; i++) {
				n = e(n, this[i], i, this)
			}
			return n
		}
	}
	if (!n.reduceRight) {
		n.reduceRight = function(e, n) {
			var r = this.length,
				i = r - 1;
			if (n === t) {
				n = this[i--]
			}
			for (; i >= 0; i--) {
				n = e(n, this[i], i, this)
			}
			return n
		}
	}
	if ([].unshift(1) !== 1) {
		var s = n.unshift;
		n.unshift = function() {
			s.apply(this, arguments);
			return this.length
		}
	}
	if (!Date.now) {
		Date.now = function() {
			return +new Date
		};
		r.getYear = function() {
			return this.getFullYear() - 1900
		};
		r.setYear = function(e) {
			return this.setFullYear(e)
		}
	}
	if (!i.bind) {
		i.bind = function(e) {
			if (arguments.length < 2 && e === t) {
				return this
			}
			var r = this,
				i = function() {}, o = n.slice.call(arguments, 1),
				a = function() {
					var t = o.concat.apply(o, arguments);
					e = this instanceof i && e ? this : e;
					return r.apply(e, t)
				};
			i.prototype = this.prototype;
			a.prototype = new i;
			return a
		}
	}
	if (!Object.keys) {
		Object.keys = function(e) {
			var t = !{
				toString: null
			}.propertyIsEnumerable("toString"),
				n = [],
				r = 0,
				i = 0,
				o, s, l;
			for (o in e) {
				if (a.call(e, o)) {
					n[i++] = o
				}
			}
			if (t) {
				s = "propertyIsEnumerable,isPrototypeOf,hasOwnProperty,toLocaleString,toString,valueOf,constructor".split(",");
				l = s.length;
				for (; r < l; r++) {
					o = s[r];
					if (a.call(e, o)) {
						n[i++] = o
					}
				}
			}
			return n
		}
	}
	if (!o.trim) {
		o.trim = function() {
			var e = ["\\s", "00A0", "1680", "180E", "2000-\\u200A", "200B", "2028", "2029", "202F", "205F", "3000"].join("\\u"),
				t = new RegExp("^[" + e + "]"),
				n = new RegExp("[" + e + "]$");
			return this.replace(t, "").replace(n, "")
		}
	}
})(window);
window.M1905 = window.M1905 || {};
M1905.CONFIG = {
	www_url: "http://" + window.location.host,
	img_url: "http://image11.m1905.cn/",
	phpcms_path: "/",
	cookie_pre: "WOlTvIlgRp",
	cookie_domain: ".m1905.com",
	cookie_path: "/"
};
M1905.guid = function(e) {
	return (e || "mJS_") + +new Date + (Math.random() + "").slice(-8)
};
M1905.ui = {};
M1905.Util = M1905.fn = {
	highlight: function(e, t, n) {
		var r = new RegExp(e, "i");
		t.each(function() {
			var t = $(this).text().replace(r, '<b class="' + n + '">' + e + "</b>");
			$(this).html(t)
		})
	},
	cutStr: function(e, t) {
		var n = /[^\x00-\xff]/g;
		if (e.replace(n, "mm").length <= t) {
			return e
		}
		var r = Math.floor(t / 2),
			i = arguments[2] || "";
		for (var o = r; o < e.length; o += 1) {
			if (e.substr(0, o).replace(n, "mm").length >= t) {
				return e.substr(0, o) + i
			}
		}
		return e
	},
	getRequest: function(e) {
		var t = new RegExp("(^|&)" + e + "=([^&]*)(&|$)", "i"),
			n = window.location.search.substr(1).match(t);
		return n != null ? unescape(n[2]) : null
	},
	parseColor: function(e) {
		var t, n;
		if (t = /#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(e)) {
			n = [parseInt(t[1], 16), parseInt(t[2], 16), parseInt(t[3], 16), 1]
		} else if (t = /#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(e)) {
			n = [parseInt(t[1], 16) * 17, parseInt(t[2], 16) * 17, parseInt(t[3], 16) * 17, 1]
		} else if (t = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e)) {
			n = [parseInt(t[1]), parseInt(t[2]), parseInt(t[3]), 1]
		} else if (t = /rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(e)) {
			n = [parseInt(t[1], 10), parseInt(t[2], 10), parseInt(t[3], 10), parseFloat(t[4])]
		}
		return n
	},
	throttle: function(e, t) {
		var n;
		return function() {
			var r = this,
				i = arguments;
			clearTimeout(n);
			n = setTimeout(function() {
				e.apply(r, i)
			}, t)
		}
	},
	getcookie: function(e) {
		e = M1905.CONFIG.cookie_pre + e;
		var t = e + "=";
		var n = t.length;
		var r = document.cookie.length;
		var i = 0;
		while (i < r) {
			var o = i + n;
			if (document.cookie.substring(i, o) == t) return M1905.Util.getcookieval(o);
			i = document.cookie.indexOf(" ", i) + 1;
			if (i == 0) break
		}
		return null
	},
	setcookie: function(e, t, n) {
		e = M1905.CONFIG.cookie_pre + e;
		var r = arguments.length;
		var i = arguments;
		var o = r > 5 ? i[5] : false;
		var a = new Date;
		if (n == null || n == 0) n = 1;
		a.setTime(a.getTime() + 36e5 * 24 * n);
		document.cookie = e + "=" + escape(t) + ("; path=" + M1905.CONFIG.cookie_path) + (M1905.CONFIG.cookie_domain == "" ? "" : "; domain=" + M1905.CONFIG.cookie_domain) + (o == true ? "; secure" : "") + ";expires=" + a.toGMTString()
	},
	delcookie: function(e) {
		var t = new Date;
		t.setTime(t.getTime() - 1);
		var n = M1905.Util.getcookie(e);
		e = M1905.CONFIG.cookie_pre + e;
		document.cookie = e + "=" + n + ";expires=" + t.toGMTString()
	},
	getcookieval: function(e) {
		var t = document.cookie.indexOf(";", e);
		if (t == -1) t = document.cookie.length;
		return unescape(document.cookie.substring(e, t))
	},
	getStore: function(e) {
		var t = store.get(e);
		if (t instanceof Array) {
			return t
		} else {
			return new Array
		}
	},
	favFilm: function(e) {
		var t = 100;
		var n = M1905.Util.getStore("m1905_favFilm"),
			r = n.length;
		for (var i = 0; i < r; i++) {
			if (n[i] == e) {
				n.splice(i, 1);
				break
			}
		}
		n.push(e);
		if (r > t - 1) {
			n.splice(0, r - t - 1)
		}
		store.set("m1905_favFilm", n)
	},
	hateFilm: function(e) {
		var t = 100;
		var n = M1905.Util.getStore("m1905_hateFilm"),
			r = n.length;
		for (var i = 0; i < r; i++) {
			if (n[i] == e) {
				n.splice(i, 1);
				break
			}
		}
		n.push(e);
		if (r > t - 1) {
			n.splice(0, r - t - 1)
		}
		store.set("m1905_hateFilm", n)
	},
	delFavFilm: function(e) {
		var t = M1905.Util.getStore("m1905_favFilm"),
			n = t.length;
		for (var r = 0; r < n; r++) {
			if (t[r] == e) {
				t.splice(r, 1);
				break
			}
		}
		store.set("m1905_favFilm", t)
	},
	addFav: function() {
		var e = document.title,
			t = location.href;
		try {
			window.external.addFavorite(t, e)
		} catch (n) {
			try {
				window.sidebar.addPanel(e, t, "")
			} catch (n) {
				alert("请用CTRL+D手动添加收藏")
			}
		}
	},
	setHome: function() {
		var e = location.href;
		if (document.all) {
			document.body.style.behavior = "url(#default#homepage)";
			document.body.setHomePage(e)
		} else if (window.sidebar) {
			if (window.netscape) {
				try {
					netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")
				} catch (t) {
					alert("该操作被浏览器拒绝，如果想启用该功能，请在地址栏内输入 about:config,然后将项signed.applets.codebase_principal_support 值该为true")
				}
			}
			var n = Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefBranch);
			n.setCharPref("browser.startup.homepage", e)
		}
	},
	hash_contentid: function(e) {
		var t = e.toString().split("").reverse(),
			n = Math.max(t.length, 9),
			r = [],
			i = 0;
		for (; i < n; i++) {
			if (t[i]) {
				r.push(t[i])
			} else {
				r.push("0")
			} if (i % 2 && i < 6) r.push("/")
		}
		r = r.reverse().join("");
		return r
	}
};
M1905.loadingAni = {
	temp: '<div class="loading"></div>',
	addin: function() {
		$(this).hide();
		$(this).parent().append(M1905.loadingAni.temp)
	},
	remove: function() {
		$(this).siblings(".loading").remove();
		$(this).fadeIn(500)
	}
};
this.M && $.extend(this.M, M1905);
! function(e) {
	e.fn.placeholder = function() {
		return this.each(function() {
			var t = e(this),
				n = t.closest("form"),
				r = t.text(),
				i = t.next("input");
			i.focus(function() {
				if (i.val() !== "") {
					t.hide()
				}
			}).on("keydown paste", function() {
				t.hide()
			}).blur(function() {
				if (i.val() === "") {
					t.show()
				}
			});
			t.click(function() {
				i.focus()
			});
			n.submit(function() {
				t.hide();
				!e.trim(i.val()) && i.val(r)
			}).get(0).onreset = function() {
				e(this).find("label.placeholder").show()
			}
		})
	};
	e("label.placeholder").placeholder();
	e.fn.srhfix = function(t) {
		var n = e(this).find("input[name=q]"),
			r = e(this).find("#fix_q"),
			i = e(this).find("#select_type"),
			o = r.children("ul").html();
		var a = {
			search_url: e(this).data("srhurl") || "/search/?q=",
			fix_url: e(this).data("srhfix") || "/search/sg.php?q=",
			tmpl: e(this).find("#srhfix_tmpl").html() || '<li><a href="{surl}" target="_blank">{tag}</a></li>'
		};
		var s = e.extend({}, a, t);
		n.closest("form").on("click", function(e) {
			e.stopPropagation();
			e.cancelBubble = true
		});
		r.delegate("li[class!=hd]", {
			mouseenter: function() {
				e(this).addClass("select").siblings("li").removeClass("select")
			},
			click: function() {
				window.open(e(this).children("a").attr("href"));
				return false
			}
		});
		n.keydown(function(t) {
			if (t.keyCode === 38 || t.keyCode === 40) {
				var i = r.find("li[class!=hd]"),
					o = r.find(".select");
				if (o.length == 0) {
					e(i[0]).addClass("select");
					n.val(e(i[0]).children("a").text())
				} else {
					switch (t.keyCode) {
						case 38:
							var a = o.prev("li[class!=hd]"),
								a = a.length == 0 ? i.last() : a;
							break;
						case 40:
							var a = o.next("li[class!=hd]"),
								a = a.length == 0 ? e(i[0]) : a;
							break
					}
					e(a).addClass("select").siblings().removeClass("select");
					n.val(e(a).children("a").text())
				}
			}
		});
		var l = {};
		n.keyup(function(t) {
			if (t.keyCode === 38 || t.keyCode === 40) {
				return
			}
			var a = e.trim(n.val()),
				f = s.fix_url + encodeURIComponent(a) + (i.length ? "&t=" + i.val() : "");
			if (a.length == 0) {
				r.children().empty();
				r.children().append(o);
				r.slideDown(120);
				return
			}
			if (l.hasOwnProperty(a)) {
				c(l[a]);
				return
			}
			e.getJSON(f, function(e) {
				if (e.length > 0) {
					c(e);
					l[a] = e
				}
			})
		});
		n.focus(function() {
			e(this).trigger("keyup")
		});
		e(document).on("click", function() {
			r.slideUp(200)
		});

		function c(t) {
			r.children().empty();
			e.each(t, function(e, t) {
				r.children().append(f(t, s.tmpl))
			});
			r.slideDown(120)
		}

		function f(t, n) {
			parseHtml = n.replace(/\{(.+?)\}/gi, function(n, r) {
				var i = n.replace("{", "").replace("}", "");
				if (i == "type") {
					return e(".search-select-name").text()
				}
				return t[i]
			});
			return parseHtml
		}
	};
	e(".search_panel, [data-srhfix]").srhfix();
	e(document).on("click", "[data-login]", function() {
		var t = e(this).data("login"),
			n = encodeURIComponent(location.href);
		t && (window.location = "http://openapi.passport.m1905.com/Login/Authorize/" + t + "/?ReturnUrl=" + n);
		return false
	})
}(window.jQuery);
(function() {
	var e, t;
	jQuery.uaMatch = function(e) {
		e = e.toLowerCase();
		var t = /(chrome)[ \/]([\w.]+)/.exec(e) || /(webkit)[ \/]([\w.]+)/.exec(e) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e) || /(msie) ([\w.]+)/.exec(e) || e.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e) || [];
		return {
			browser: t[1] || "",
			version: t[2] || "0"
		}
	};
	e = jQuery.uaMatch(navigator.userAgent);
	t = {};
	if (e.browser) {
		t[e.browser] = true;
		t.version = e.version
	}
	if (t.chrome) {
		t.webkit = true
	} else {
		if (t.webkit) {
			t.safari = true
		}
	}
	jQuery.browser = t
})();