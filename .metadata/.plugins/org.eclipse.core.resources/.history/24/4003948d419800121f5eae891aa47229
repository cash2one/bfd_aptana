/**
 * @author Administrator
 */$.ajaxSettings.traditional=!0,$(function(){var e=$("#siteId").val();$(".choose2 > li").click(function(){$(this).hasClass("current")||(document.title="流量交换-"+$(this).find("a").html(),$(this).siblings().removeClass("current"),$(this).addClass("current"),$(".section").hide().eq($(this).index()).show())}),$(".select_box:not(#notcontentselect) input:text").click(function(){$(".select_box3").find("ul").not($(this).parents(".select_box3").find("ul")).slideUp(),$(this).parents(".select_box").find("ul").slideToggle()}),$(".select_box:not(#notcontentselect) ul li").click(function(){$(this).parents(".select_box").find("input:text").val($(this).html()),$(this).parents(".select_box").find("ul li.active").removeClass("active"),$(this).addClass("active"),$(this).parents(".select_box").find("ul").slideUp(),$(this).parents(".select_box").find("input:hidden").val($(this).data("value"))}),$("body").click(function(e){!$(e.target).is(".select_box:not(#notcontentselect)")&&$(e.target).parents(".select_box:not(#notcontentselect)").size()==0&&$(".select_box:not(#notcontentselect)").find("ul").slideUp()}),$(".select_box:not(#notcontentselect) input:hidden").each(function(){var e=$(this).val();e!==""&&$(this).parents(".select_box").find("li").each(function(){$(this).data("value")===e&&$(this).click()})})}),$(function(){function t(e,t,n,r){var i,s,o={container:".section:eq("+e+") > table > tbody",rowList:10,getData:function(){var t=$.trim($(".section:eq("+e+") input:text:last").val()),n=$.trim($(".section:eq("+e+") input:hidden").val());return $(".section:eq("+e+') .type-search a:contains("筛选")').click(function(){n===$.trim($(".section:eq("+e+") input:hidden").val())?$.ifmWidget("alertFail",{title:"请修改筛选内容",content:"请修改网站类型"}):(n=$.trim($(".section:eq("+e+") input:hidden").val()),i.reset())}),$(".section:eq("+e+") .type-search a:last").click(function(){t===$.trim($(".section:eq("+e+") input:text:last").val())?$.ifmWidget("alertFail",{title:"请修改查询信息",content:"请修改查询信息"}):(t=$.trim($(".section:eq("+e+") input:text:last").val()),$(".section:eq("+e+") .type-search .ts-left").hide(),$(".section:eq("+e+") .type-search > span").show(),i.reset())}),$(".section:eq("+e+") .type-search > span a").click(function(){$(".section:eq("+e+") .type-search .ts-left").show(),$(".section:eq("+e+") .type-search > span").hide(),$(".section:eq("+e+") input:text:last").val(""),t="",i.reset()}),function(){return $(".section:eq("+e+") .type-search .ts-left").is(":visible")?{"site.type.id":n}:{q:t}}}(e),Model:function(e,t){var i=this;t.operate=r,i.dom=$.tmpl(n,t),e%2==0?null:i.dom.addClass("color"),i.dom.data("item",t)},beforeLoad:function(){$.ifmWidget("loading",{title:"加载中",content:"加载中..."})},afterLoad:function(){$.ifmWidget("unloading")},page:{container:".section:eq("+e+") > ul"}},u=$.extend(!0,o,t);return i=new List(u),i}function o(e,t){var n={beforeLoad:$.noop,afterLoad:$.noop},r=e.getSetting(),i={beforeLoad:r.beforeLoad,afterLoad:r.afterLoad};return $.extend(r,$.extend(n,t)),function(){r.beforeLoad=i.beforeLoad,r.afterLoad=i.afterLoad}}function u(e){if($(".choose2 li:first").is(".current"))return r=null,i=null,s=null,o(n,e);if($(".choose2 li:eq(1)").is(".current"))return i=null,n=null,o(r,e);if($(".choose2 li:eq(2)").is(".current"))return r=null,n=null,o(i,e);if($(".choose2 li:eq(3)").is(".current"))return n=null,$.noop}function a(e){$.ifmWidget("loading",{title:"正在操作",content:"正在操作..."}),e.done(function(e){var t=u({afterLoad:function(){t(),$.ifmWidget("tip",{content:"操作成功"})}});$(".choose2 li:first").is(".current")?n.flush():$(".choose2 li:eq(1)").is(".current")?r.flush():$(".choose2 li:eq(2)").is(".current")&&i.flush()}).fail(function(){$.ifmWidget("alertFail",{title:"操作失败",content:"操作失败"})})}var e=$("#siteId").val();$.template("t1",'<tr><td style="text-align:center;"><span class="blue"><a href="../../SourceShare/source/!showSiteInformation?myselfId='+e+'&otherId=${id}">${site_name}</a></span><span class="site">${site_address}</span></td>'+'<td style="text-align:center;"><span>${type}</span></td>'+'<td class="pl14"><span>${desc}</span></td>'+'<td style="text-align:center;"><span>${sim_rate}</span></td>'+'<td class="brn">{{html operate}}<!--<a href="#" class="apply">申请交换</a>--></td>'+"</tr>"),$.template("t2",'<tr><td style="text-align:center;"><span class="blue"><a href="../../SourceShare/source/!showSiteInformation?myselfId='+e+'&otherId=${id}">${site_name}</a></span><span class="site">${site_address}</span></td>'+'<td style="text-align:center;"><span>${type}</span></td>'+'<td class="pl14"><span>${desc}</span></td>'+'<td  class="brn" style="text-align:center;"><span>${sim_rate}</span></td>'+"</tr>");var n,r,i,s;$(".choose2 > li:eq(0)").click(function(){n||(n=t(0,{url:"../../SourceShare/source/!getNoExchange",data:{}},"t1",'<a class="apply">申请交换</a>'))}).click(),$(".choose2 > li:eq(1)").click(function(){r||(r=t(1,{url:"../../SourceShare/source/!getYetExchange",data:{}},"t1",'<a class="apply">取消交换</a>'))}),$(".choose2 > li:eq(2)").click(function(){i||(i=t(2,{url:"../../SourceShare/source/!getIngBExchange",data:{},onLoad:function(e){(e.totalItem||e.totalItem==0)&&$(".choose2 > li:eq(2) a").html("等待您回应("+e.totalItem+")")}},"t1",'<a class="pass">通过</a><a class="refuse">拒绝</a>'))}),$(".choose2 > li:eq(3)").click(function(){s||(s=t(3,{url:"../../SourceShare/source/!getIngAExchange",data:{},onLoad:function(e){(e.totalItem||e.totalItem==0)&&$(".choose2 > li:eq(3) a").html("等待对方回应("+e.totalItem+")")}},"t2"))}),$(".section").delegate('td a:contains("申请交换")',"click",function(){var t=$(this).parent();$.ifmWidget("confirmNormal",{yesCallBack:function(){a($.post("../../SourceShare/source/!applyExchangeFlow",{applicationId:e,beApplicationId:t.parent().data("item").id}))},title:"确认申请交换",content:"确定要申请交换吗?"})}),$(".section").delegate('td a:contains("取消交换")',"click",function(){var e=$(this).parent();$.ifmWidget("confirmNormal",{yesCallBack:function(){a($.post("../../SourceShare/source/!cancelExchangeFlow",{applicationId:e.parent().data("item").id}))},title:"确认取消交换",content:"确定要取消交换吗?"})}),$(".section").delegate('td a:contains("通过")',"click",function(){var t=$(this).parent();$.ifmWidget("confirmNormal",{yesCallBack:function(){a($.post("../../SourceShare/source/!agreeExchangeFlow",{beApplicationId:e,applicationId:t.parent().data("item").id}))},title:"确认通过申请",content:"确定要通过申请吗?"})}),$(".section").delegate('td a:contains("拒绝")',"click",function(){var t=$(this).parent();$.ifmWidget("confirmNormal",{yesCallBack:function(){a($.post("../../SourceShare/source/!refuseExchangeFlow",{beApplicationId:e,applicationId:t.parent().data("item").id}))},title:"确认拒绝申请",content:"确定要拒绝申请吗?"})})}),$(function(){var e=$("#siteId").val();$(".amend").click(function(){$.blockUI({message:$(".page-area"),css:{border:"none",width:"588px",top:($(window).height()-577)/2>0?($(window).height()-577)/2:"0px",left:($(window).width()-554)/2+"px"},overlayCSS:{opacity:0}})}),$(".p-title a").click(function(){$.unblockUI()})}),$(function(){var e=$("#siteId").val();$("#nameinput").val()!==""&&$("#namelabel").hide(),$("#nameinput").focus(function(){$("#namelabel").hide()}).blur(function(){$(this).val()==""&&$("#namelabel").show()}),$("#namelabel").click(function(){$(this).hide(),$("#nameinput").focus()}),$("#qq").val()!==""&&$("#qqlabel").hide(),$("#qq").focus(function(){$("#qqlabel").hide()}).blur(function(){$(this).val()==""&&$("#qqlabel").show()}),$("#qqlabel").click(function(){$(this).hide(),$("#qq").focus()}),$("#notcontentselect input:text").click(function(){$(".select_box3").find("ul").not($(this).parents(".select_box3").find("ul")).slideUp(),$("#notcontentselect ul").slideToggle()}),$("#notcontentselect ul li").click(function(){$("#notcontentselect input:text").val($(this).html()),$("#notcontentselect ul").find("li.active").removeClass("active"),$(this).addClass("active"),$("#notcontentselect ul").slideUp(),$(".btn").show(),$("#notcontentselect input:hidden:last").val($(this).data("value")),$("#form1").valid()}),$("body").click(function(e){!$(e.target).is("#notcontentselect")&&$(e.target).parents("#notcontentselect").size()==0&&$("#notcontentselect").find("ul").slideUp()}),function(){var e=$("#notcontentselect input:hidden:last").val();$("#notcontentselect").find("li").each(function(){$(this).data("value")==e&&($("#notcontentselect input:text").val($(this).html()),$("#notcontentselect ul").find("li.active").removeClass("active"),$(this).addClass("active"))})}()}),$(function(){var e=$("#siteId").val();$("#sub").click(function(){$("#form1").submit()}),$("#form1").keyup(function(e){e.keyCode===13&&$("#form1").submit()}),$.validator.addMethod("checkboxchecked",function(e,t){return $(".cbox:checked").size()>0},"请选择联系方式"),$.validator.addMethod("qqchecked",function(e,t){return $.trim($("#qq").val())!=""&&!/^[1-9]\d{4,11}$/.test($.trim($("#qq").val()))?!1:!0},"请输入正确的qq号码"),$.validator.addMethod("sitetype",function(e,t){return $("#sitetype").val()!=="请选择"},"请选择网站类型");var t=$("#form1").validate({submitHandler:function(e){return $(e).ajaxSubmit({success:function(e,n,r,i){e=="0"?$.ifmWidget("alertSuccess",{title:"操作成功",content:"操作成功"}):e=="1"&&t.showErrors({"site.name":"操作失败"})}}),!1},rules:{"site.name":{required:!0},"site.describe":{required:!0},"site.qqNumber":{qqchecked:!0},sitetype:{sitetype:!0}},messages:{"site.name":{required:"请输入网站名称"},"site.describe":{required:"请输入网站描述"}},focusInvalid:!0,onkeyup:!1,wrapper:null,errorElement:"span",errorClass:"site_info_error_f",errorPlacement:function(e,t){t.is("textarea")?e.appendTo(t.parent()):e.appendTo(t.parent().parent())}})});